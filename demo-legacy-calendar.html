<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Legacy Calendar Demo - Roommate Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-md border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <div class="flex items-center space-x-3">
                <div class="bg-blue-600 p-2 md:p-3 rounded-lg">
                    <i class="fas fa-home text-white text-lg md:text-xl"></i>
                </div>
                <div>
                    <h1 class="text-xl md:text-2xl font-bold text-gray-800">
                        Roommate Portal - Legacy Calendar Demo
                    </h1>
                    <p class="text-xs md:text-sm text-gray-600">Custom Calendar Implementation (Fallback)</p>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 py-4 md:py-8">
        <!-- Calendar Section -->
        <section id="calendarSection" class="tab-content">
            <div class="bg-white rounded-2xl shadow-xl p-4 md:p-8 border border-gray-100">
                <div class="flex flex-col space-y-4 md:flex-row md:items-center md:justify-between md:space-y-0 mb-6">
                    <div class="flex items-center space-x-3">
                        <div class="bg-indigo-100 p-3 rounded-xl">
                            <i class="fas fa-calendar-alt text-indigo-600 text-xl"></i>
                        </div>
                        <h2 class="text-xl md:text-2xl font-bold text-gray-800">Shared Calendar (Legacy)</h2>
                    </div>
                </div>

                <!-- Legacy Calendar Notice -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                    <div class="flex items-center">
                        <i class="fas fa-info-circle text-blue-600 mr-3"></i>
                        <div>
                            <h4 class="font-semibold text-blue-800">Legacy Calendar Implementation</h4>
                            <p class="text-blue-700 text-sm">This demonstrates the original custom calendar that serves as a fallback when FullCalendar is unavailable.</p>
                        </div>
                    </div>
                </div>

                <!-- Calendar Navigation -->
                <div class="flex items-center justify-between mb-6">
                    <button id="prevMonthBtn" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors">
                        <i class="fas fa-chevron-left mr-2"></i>Previous
                    </button>
                    <h3 id="currentMonthYear" class="text-xl font-bold text-gray-800">January 2024</h3>
                    <div class="flex space-x-2">
                        <button id="todayBtn" class="px-4 py-2 bg-indigo-100 text-indigo-700 rounded-lg hover:bg-indigo-200 transition-colors">
                            Today
                        </button>
                        <button id="nextMonthBtn" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors">
                            Next<i class="fas fa-chevron-right ml-2"></i>
                        </button>
                    </div>
                </div>

                <!-- Legacy Calendar Grid -->
                <div id="calendarGrid" class="calendar-grid grid grid-cols-7 gap-1 bg-gray-100 p-4 rounded-lg">
                    <!-- Calendar days will be dynamically added here -->
                </div>
            </div>
        </section>
    </main>

    <script>
        // Mock data for demonstration
        const mockEvents = [
            {
                id: '1',
                title: 'House Meeting',
                startDate: '2024-01-15T19:00:00',
                endDate: '2024-01-15T20:00:00',
                description: 'Monthly house meeting',
                location: 'Living Room',
                privacy: 'shared',
                isAllDay: false,
                createdByName: 'John Doe'
            },
            {
                id: '2',
                title: 'Doctor Appointment',
                startDate: '2024-01-20T10:00:00',
                endDate: '2024-01-20T12:00:00',
                description: 'Private medical appointment',
                location: 'Medical Center',
                privacy: 'private',
                isAllDay: false,
                createdByName: 'Jane Smith'
            },
            {
                id: '3',
                title: 'Weekend Cleanup',
                startDate: '2024-01-27T00:00:00',
                endDate: '2024-01-27T23:59:59',
                description: 'Deep cleaning day',
                location: 'Entire House',
                privacy: 'shared',
                isAllDay: true,
                createdByName: 'Mike Johnson'
            }
        ];

        // Simplified calendar implementation for demo
        const calendar = {
            currentDate: new Date(),
            events: mockEvents,

            init() {
                this.setupNavigation();
                this.renderCalendar();
            },

            setupNavigation() {
                document.getElementById('prevMonthBtn').addEventListener('click', () => {
                    this.currentDate.setMonth(this.currentDate.getMonth() - 1);
                    this.renderCalendar();
                });

                document.getElementById('nextMonthBtn').addEventListener('click', () => {
                    this.currentDate.setMonth(this.currentDate.getMonth() + 1);
                    this.renderCalendar();
                });

                document.getElementById('todayBtn').addEventListener('click', () => {
                    this.currentDate = new Date();
                    this.renderCalendar();
                });
            },

            renderCalendar() {
                const calendarGrid = document.getElementById('calendarGrid');
                const currentMonthYear = document.getElementById('currentMonthYear');

                // Update month/year display
                const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                    'July', 'August', 'September', 'October', 'November', 'December'];
                currentMonthYear.textContent = `${monthNames[this.currentDate.getMonth()]} ${this.currentDate.getFullYear()}`;

                // Clear calendar
                calendarGrid.innerHTML = '';

                // Add day headers
                const headerRow = document.createElement('div');
                headerRow.className = 'calendar-header-row grid grid-cols-7 gap-1 mb-1';
                
                const dayHeaders = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                dayHeaders.forEach(day => {
                    const dayHeader = document.createElement('div');
                    dayHeader.className = 'calendar-day-header text-center font-semibold text-gray-600 py-2';
                    dayHeader.textContent = day;
                    headerRow.appendChild(dayHeader);
                });
                calendarGrid.appendChild(headerRow);

                // Get first day of month and number of days
                const firstDay = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth(), 1);
                const lastDay = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() + 1, 0);
                const daysInMonth = lastDay.getDate();
                const startingDayOfWeek = firstDay.getDay();

                // Create week rows
                const totalCells = startingDayOfWeek + daysInMonth;
                const weeks = Math.ceil(totalCells / 7);

                for (let week = 0; week < weeks; week++) {
                    const weekRow = document.createElement('div');
                    weekRow.className = 'calendar-week-row grid grid-cols-7 gap-1 mb-1';
                    weekRow.style.minHeight = '120px';

                    for (let dayOfWeek = 0; dayOfWeek < 7; dayOfWeek++) {
                        const cellIndex = week * 7 + dayOfWeek;
                        const dayNumber = cellIndex - startingDayOfWeek + 1;

                        if (cellIndex < startingDayOfWeek || dayNumber > daysInMonth) {
                            // Empty cell
                            const emptyDay = document.createElement('div');
                            emptyDay.className = 'calendar-day calendar-day-empty';
                            weekRow.appendChild(emptyDay);
                        } else {
                            // Actual day cell
                            const dayElement = document.createElement('div');
                            dayElement.className = 'calendar-day cursor-pointer hover:bg-gray-100 transition-colors p-2 border border-gray-200 bg-white';
                            
                            const currentDate = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth(), dayNumber);
                            const isToday = this.isToday(currentDate);
                            
                            if (isToday) {
                                dayElement.classList.add('bg-blue-50', 'border-blue-300');
                            }

                            // Get events for this day
                            const dayEvents = this.getEventsForDay(currentDate);
                            
                            dayElement.innerHTML = `
                                <div class="calendar-day-number ${isToday ? 'font-bold text-blue-600' : 'text-gray-700'} mb-2">${dayNumber}</div>
                                <div class="calendar-day-events space-y-1">
                                    ${dayEvents.slice(0, 2).map(event => `
                                        <div class="calendar-event ${event.privacy === 'private' ? 'bg-purple-600' : 'bg-green-600'} text-white text-xs px-2 py-1 rounded cursor-pointer"
                                             title="${event.title}${event.description ? ' - ' + event.description : ''}">
                                            <i class="fas ${event.privacy === 'private' ? 'fa-lock' : ''} mr-1"></i>
                                            ${event.isAllDay ? '<i class="fas fa-calendar mr-1"></i>' : ''}
                                            ${event.title}
                                        </div>
                                    `).join('')}
                                    ${dayEvents.length > 2 ? `<div class="text-xs text-gray-500">+${dayEvents.length - 2} more...</div>` : ''}
                                </div>
                            `;

                            dayElement.addEventListener('click', () => {
                                alert(`Clicked on ${currentDate.toDateString()}\nEvents: ${dayEvents.length}\n\n${dayEvents.map(e => `• ${e.title} (${e.privacy})`).join('\n')}`);
                            });

                            weekRow.appendChild(dayElement);
                        }
                    }

                    calendarGrid.appendChild(weekRow);
                }
            },

            isToday(date) {
                const today = new Date();
                return date.toDateString() === today.toDateString();
            },

            getEventsForDay(date) {
                return this.events.filter(event => {
                    const eventStart = new Date(event.startDate);
                    const eventEnd = new Date(event.endDate);
                    const eventStartDate = new Date(eventStart.getFullYear(), eventStart.getMonth(), eventStart.getDate());
                    const eventEndDate = new Date(eventEnd.getFullYear(), eventEnd.getMonth(), eventEnd.getDate());
                    const checkDate = new Date(date.getFullYear(), date.getMonth(), date.getDate());
                    
                    return checkDate >= eventStartDate && checkDate <= eventEndDate;
                });
            }
        };

        // Initialize calendar when page loads
        document.addEventListener('DOMContentLoaded', () => {
            calendar.init();
        });
    </script>
</body>
</html>
